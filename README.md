# Разработка витрины данных  
# по поездкам такси
__Задание:__
Необходимо, используя таблицу поездок для каждого дня, рассчитать процент поездок по количеству человек в машине.  
По итогу должна получиться таблица (parquet) с колонками date, percentage_zero, percentage_1p, percentage_2p, percentage_3p, percentage_4p_plus.  
___Полное техзадание прилагается: doc/Техзадание.rtf___

## Технологический стек:
__Apache Spark__: обеспечивает высокую скорость загрузки и обработки данных больших объемов.  
__Python(библиотеки pyspark, pyarrow, pandas, seaborn)__: гибкость, широкий функционал для обработки данных. Возможность использовать разнообразные библиотеки.    
__Conda+Jupiter Notebook__:  Легкость настройки, интерактивность, удобство разработки и визуализации результатов.

## Реализация
Реализация проекта приближена к ELT процессу.  
![image](https://github.com/Oleg-2023/final_project/assets/144448179/e2265b46-81c3-4b22-a4cf-eeccf6e53a98)  
___doc/Блок-Схема.drawio___

На внешнем источнике расположены ранее извлеченные данные по поездкам.  
Они загружаются в Spark Dataframe, где затем обрабатываются инструментами pyspark: 
- Производится предварительный анализ.
- Удаляются аномалии(0.3% отсутствующих данных, поездки отрицательной и нулевой стоимостью)
- Данные трансформируются, реализованными в pyspark SQL функциями:
  - Добавлены новые колонки по количеству пассажиров, минимальными и максимальными оплатами поездки.
  - Рассчитаны и заполненны значения новых колонок
- Сформирована витрина данных
- Витрина экспортирована в файл формата parquet: __output/yellow_trips_datamart.parquet__

Полный код данной части проекта прилагается в файле __src/YellowTrips-ELT.jpynb__

## Дополнительная часть.  
###  Аналитика. Построить графики на тему «Как пройденное расстояние и количество пассажиров влияют на чаевые.

## Технологический стек:
__Python(библиотеки pandas, seaborn)__: гибкость, широкий функционал для обработки данных. Возможность использовать разнообразные библиотеки.    
__Jupiter Notebook__:  Легкость настройки, интерактивность, удобство разработки и визуализации результатов.

## Реализация  
___Для аналитики и построения графиков использовались исходные данные.___

### График зависимости пройденного расстояния на чаевые

![image](https://github.com/Oleg-2023/final_project/assets/144448179/895d8abb-5118-4082-8b92-f65406ead60c)


### График количества пассажиров на чаевые  

![image](https://github.com/Oleg-2023/final_project/assets/144448179/92532928-fd7d-4899-ae5b-55071cbede60)

#### Вывод по графикам
- чаевые резко возрастают при количестве пассажиров более 6  
(что составляеет крайне малую часть набора данных)
- Влияние расстояния на чаевые значительно: от 25 до 110 миль средние чаевые значительно выше) 


### Кореляционная матрица, взаимозависимость данных по количеству пассажиров, пройденному пути, типу оплаты, чаевым и оплатой за проезд  

![image](https://github.com/Oleg-2023/final_project/assets/144448179/8ccab7d3-40bb-4ee5-89d9-c3b63a45260a)  

#### Вывод по корелляционной матрице
- Влияние количества пассажиров на чаевые крайне мало (можно пренебречь. Выше на графике рост >6 пассажиров, но таких поездок очень мало)
- Влияние расстояния на чаевые значительно
- На чаевые больше всего оказывает влияние общая сумма оплаты
- Так же на чаевые существенно влияет тип оплаты
- Самая существенная зависимость стоимости оплаты от расстояния

Полный код данной части проекта прилагается в файле __src/analitics.jpynb__






